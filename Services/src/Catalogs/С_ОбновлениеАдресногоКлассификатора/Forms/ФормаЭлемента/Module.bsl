&НаСервере
Функция  ВыгрузитьНаСервере()

 МассивОбластей = Новый Массив(7);
 ОбластьВыгрузки = 7;
 
 // инициализируем их значениями
 МассивОбластей[0] = Число(10000000000000000000);
 МассивОбластей[1] = Число(20000000000000000000);
 МассивОбластей[2] = Число(30000000000000000000); 
 МассивОбластей[3] = Число(40000000000000000000); 
 МассивОбластей[4] = Число(50000000010000000000); 
 МассивОбластей[5] = Число(60000000000000000000);
 МассивОбластей[6] = Число(70000000000000000000);
 
 Для Счт = 1 по ОбластьВыгрузки Цикл 
	 
	 Запрос = Новый Запрос;
	 
	 Запрос.УстановитьПараметр("МассивРегионов", Счт);
	 запрос.УстановитьПараметр("МассивОбластей", МассивОбластей);
	 
	 Запрос.Текст ="ВЫБРАТЬ
	 | АдресныйКлассификатор_Локализация_Без_Регионов.ТипАдресногоЭлемента,
	 | АдресныйКлассификатор_Локализация_Без_Регионов.КодАдресногоОбъектаВКоде,
	 | АдресныйКлассификатор_Локализация_Без_Регионов.КодРайонаВКоде,
	 | АдресныйКлассификатор_Локализация_Без_Регионов.КодГородаВКоде,
	 | АдресныйКлассификатор_Локализация_Без_Регионов.КодНаселенногоПунктаВКоде,
	 | АдресныйКлассификатор_Локализация_Без_Регионов.КодУлицыВКоде,
	 | АдресныйКлассификатор_Локализация_Без_Регионов.Код КАК Код,
	 | АдресныйКлассификатор_Локализация_Без_Регионов.Наименование,
	 | АдресныйКлассификатор_Локализация_Без_Регионов.Сокращение,
	 | АдресныйКлассификатор_Локализация_Без_Регионов.Индекс,
	 | АдресныйКлассификатор_Локализация_Без_Регионов.АльтернативныеНазвания,
	 | АдресныйКлассификатор_Локализация_Без_Регионов.ПризнакАктуальности
	 |ИЗ
	 | РегистрСведений.С_АдресныйКлассификатор КАК АдресныйКлассификатор_Локализация_Без_Регионов
	 |ГДЕ
	 | АдресныйКлассификатор_Локализация_Без_Регионов.КодАдресногоОбъектаВКоде В(&МассивРегионов) И НЕ
	 | АдресныйКлассификатор_Локализация_Без_Регионов.Код В (&МассивОбластей)
	 |
	 |УПОРЯДОЧИТЬ ПО
	 | Код";
	 
	 
	 РезЗапроса = Запрос.Выполнить().Выгрузить();
	 
	 ТабДокумент = Новый ТабличныйДокумент;
	 
	 Заголовки = Новый Структура;
	 ОбластьВывода = ТабДокумент.ПолучитьОбласть(1, 1, 1, РезЗапроса.Колонки.Количество());
	 Для Счетчик = 1 по РезЗапроса.Колонки.Количество() Цикл
		 ОбластьЗаполнения = ОбластьВывода.Область(1, Счетчик, 1, Счетчик);
		 Колонка = РезЗапроса.Колонки[Счетчик-1];
		 ОбластьЗаполнения.Параметр = Колонка.Имя;
		 ОбластьЗаполнения.Заполнение = ТипЗаполненияОбластиТабличногоДокумента.Параметр;
		 Заголовки.Вставить(Колонка.Имя, Колонка.Имя);
	 КонецЦикла;
	 ОбластьВывода.Параметры.Заполнить(Заголовки);
	 ТабДокумент.Вывести(ОбластьВывода);
	 
	 Выборка=Запрос.Выполнить().Выбрать();
	 Пока Выборка.Следующий() Цикл
		 ОбластьВывода.Параметры.Заполнить(Выборка);
		 ТабДокумент.Вывести(ОбластьВывода);
	 КонецЦикла;
	 
	 //КонвертироватьВXML 
	 Колонок = ТабДокумент.ШиринаТаблицы;
	 ИменаКолонок = Новый Массив;
	 ИменаКолонокСтр = "";
	 Для Сч = 1 По Колонок Цикл
		 ИмяТаблицы = ТабДокумент.Область(1, Сч).Текст;
		 ИменаКолонок.Добавить(ИмяТаблицы);
		 ИменаКолонокСтр = ИменаКолонокСтр + ?(Сч = 1, "", ",") + ИмяТаблицы;
	 КонецЦикла;
	 
	 Запись = Новый ЗаписьXML;
	 Запись.УстановитьСтроку("UTF-8");
	 Запись.ЗаписатьНачалоЭлемента("Items");
	 
	 Для СчСтр = 2 По ТабДокумент.ВысотаТаблицы Цикл
		 Запись.ЗаписатьНачалоЭлемента("Item");
		 Для СчКол = 1 По Колонок Цикл
			 Запись.ЗаписатьАтрибут(ИменаКолонок[СчКол-1], ТабДокумент.Область(СчСтр, СчКол).Текст);
		 КонецЦикла;
		 Запись.ЗаписатьКонецЭлемента();
	 КонецЦикла;
	 
	 Запись.ЗаписатьКонецЭлемента();
	 
		 Объект["Текст" + Строка(Счт)] = Запись.Закрыть();
		 Объект["Текст" + Строка(Счт)]  = СтрЗаменить(Объект["Текст" + Строка(Счт)], "<Items>" + Символы.ПС, "");
		 Объект["Текст" + Строка(Счт)]  = СтрЗаменить(Объект["Текст" + Строка(Счт)], "</Items>" , "");
	 
	 ОбластьВывода.Очистить();
	 ТабДокумент.Очистить();
	 
 КонецЦикла; 
 Записать();
КонецФункции

&НаКлиенте
Процедура Выгрузить(Команда)
 
 Док = ВыгрузитьНаСервере();
КонецПроцедуры

&НаКлиенте
Процедура Очистить(Команда)
	
	Объект.Текст1 = "";
	Объект.Текст2 = "";
	Объект.Текст3 = "";
	Объект.Текст4 = "";
	Объект.Текст5 = "";
	Объект.Текст6 = "";
	Объект.Текст7 = "";
	
КонецПроцедуры
